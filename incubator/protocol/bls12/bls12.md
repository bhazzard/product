# BLS12-381 cryptography

This document describes a proposed [change to the EOSIO protocol](../README.md) to add new host functions that efficiently allow contracts to execute computations related to the BLS12-381 elliptic curve, including verifying BLS signatures and aggregate BLS signatures.

## Dependencies on other protocol features

None

## Benefits

* If a transaction uses BLS signatures, multiple signatures on the transaction (even of different messages) can be aggregated into one to save space and in some cases computation cost.
* Needed as prerequisite for consensus algorithms with performance properties that scale efficiently with the number of finalizers (fast finality).
* Supports some zkSNARK schemes (privacy applications).
* Greater compatibility Ethereum 2.0.

## Details

Host functions for the alt_bn128 curve were included as part of to the 3.1.0 release of EOSIO. As a pairing-friendly curve, this provides use cases in both zkSNARKs and (at least theoretically) aggregate signatures. But the BLS12-381 elliptic curve is another pairing-curve that also provides similar use cases but with greater bits of security. It also has the benefit of being used in other popular cryptocurrency projects like Ethereum 2.0 and ZCash. 

Aggregate signatures have been identified as necessary to meet the requirements of this EOSIO+ Coalition [RFP](https://github.com/eosnetworkfoundation/Coalition-RFPs/blob/main/2022%2004%20RFP%20-%20Faster%20Finality.pdf). BLS signatures will almost certainly be the ideal candidate for supporting aggregate signatures for that purpose. And if the consensus algorithm uses BLS signature based on the BLS12-381 elliptic curve, there can be further benefits such as more efficiently verifying the finality proofs from an EOSIO blockchain within a smart contract running on the Ethereum 2.0 blockchain (thus enabling cheaper IBC between EOSIO blockchains and Ethereum).

For more information on the BLS12-381 elliptic curve in general, see:
* https://electriccoin.co/blog/new-snark-curve/
* https://hackmd.io/@benjaminion/bls12-381
* https://eips.ethereum.org/EIPS/eip-2537


For further detail on BLS signatures, see: 
* https://www.iacr.org/archive/asiacrypt2001/22480516.pdf
* https://hackmd.io/@liangcc/bls-solidity
* https://hackmd.io/@benjaminion/bls12-381

For further detail on BLS aggregate signatures, see:
* https://eprint.iacr.org/2018/483.pdf
* https://hackmd.io/@benjaminion/bls12-381
* https://crypto.stanford.edu/~dabo/pubs/papers/BLSmultisig.html

The actual protocol feature must introduce sufficient host functions to allow efficiently implementing a variety of cryptographic schemes using the BLS12-384 elliptic curve, including BLS (aggregate) signatures and zkSNARKs. See the precompiles in https://eips.ethereum.org/EIPS/eip-2537 for a breakdown of the host functions that should be available as part of activation of the protocol feature. 

In addition, delivery of this feature should be accompanied by C++ library code added to CDT which uses these new host functions to implement the following which can be efficiently computed within contracts: BLS signatures verification; and, adding BLS public keys together to generate a aggregate public key that can be used to verify a BLS aggregate signature (at least a version that does not need to be concerned about rogue key attacks due to requiring proof of knowledge of the secret key for each individual public key being aggregated.

The protocol feature does not require adding support for the BLS signature scheme through new types of public keys or signatures supported at the level of the EOSIO protocol. However, delivery of this feature should also include a reference contract that demonstrates how it can verify a BLS signature. In addition, native code should be built into cleos to generate a BLS signature on an arbitrary message digest and this should be leveraged in a test showing how a BLS signature can be generated by the client and then correctly validated by the smart contract.
